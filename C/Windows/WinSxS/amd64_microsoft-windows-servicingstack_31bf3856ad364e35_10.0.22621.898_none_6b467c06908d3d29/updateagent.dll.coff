Microsoft (R) COFF/PE Dumper Version 14.29.30137.0
Copyright (C) Microsoft Corporation.  All rights reserved.


Dump of file C:\Windows\WinSxS\amd64_microsoft-windows-servicingstack_31bf3856ad364e35_10.0.22621.898_none_6b467c06908d3d29\updateagent.dll

File Type: DLL

  Image has the following dependencies:

    OLEAUT32.dll
    WINTRUST.dll
    CRYPT32.dll
    ntdll.dll
    ADVAPI32.dll
    KERNEL32.dll
    OLE32.dll
    USER32.dll
    VERSION.dll
    SHLWAPI.dll
    RPCRT4.dll
    wer.dll
    CFGMGR32.dll

  Image has the following delay load dependencies:

    WIMGAPI.DLL

  Section contains the following exports for UpdateAgent.dll

    00000000 characteristics
    704168AC time date stamp
        0.00 version
           1 ordinal base
          12 number of functions
          12 number of names

    ordinal hint RVA      name

          1    0 00064090 CreateDeploymentSession
          2    1 00064040 CreateDeploymentSessionEx
          3    2 00063FE0 CreateOfflineDeploymentSession
          4    3 0001A130 UA_CommitActionList
          5    4 00018930 UA_CreateActionList
          6    5 000186B0 UA_CreateActionList2
          7    6 00018AA0 UA_CreateDeviceInformation
          8    7 00018BD0 UA_CreateDownloadList
          9    8 00019B50 UA_CreateDownloadListFromActionList
         10    9 00018E00 UA_CreatePackageListFromDownloadList
         11    A 00019F30 UA_InstallActionList
         12    B 00019CB0 UA_ReleaseDownloadList

  Section contains the following imports:

    OLEAUT32.dll
             180288380 Import Address Table
             180328B48 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                             Ordinal   185
                             Ordinal     8
                             Ordinal     6
                             Ordinal     2
                             Ordinal   184
                             Ordinal     9

    WINTRUST.dll
             180288430 Import Address Table
             180328BF8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          6D WTHelperProvDataFromStateData
                          68 WTHelperGetProvSignerFromChain
                          66 WTHelperGetProvCertFromChain
                          90 WinVerifyTrust

    CRYPT32.dll
             180287C90 Import Address Table
             180328458 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          9E CryptHashCertificate2
                          76 CertVerifyCertificateChainPolicy

    ntdll.dll
             180288458 Import Address Table
             180328C20 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          23 DbgPrintEx
                         635 RtlUpcaseUnicodeChar
                         3B3 RtlDowncaseUnicodeChar
                         407 RtlFormatCurrentUserKeyPath
                         577 RtlReAllocateHeap
                         644 RtlValidAcl
                          CF NtAdjustPrivilegesToken
                         5D2 RtlSetSaclSecurityDescriptor
                         648 RtlValidSid
                         159 NtDuplicateToken
                         454 RtlGetSaclSecurityDescriptor
                         44D RtlGetOwnerSecurityDescriptor
                         2E1 RtlAllocateAndInitializeSid
                         346 RtlCopySid
                         5C2 RtlSetGroupSecurityDescriptor
                         3E7 RtlFindAceByType
                         148 NtDelayExecution
                         353 RtlCreateEnvironmentEx
                         3DD RtlExpandEnvironmentStrings_U
                         1EB NtQueryInformationToken
                         51F RtlNtStatusToDosErrorNoTeb
                         51E RtlNtStatusToDosError
                         5A6 RtlRunOnceComplete
                         5A5 RtlRunOnceBeginInitialize
                         3F7 RtlFindNextForwardRunClear
                         526 RtlNumberOfSetBits
                         49E RtlInitializeSRWLock
                         589 RtlReleaseSRWLockExclusive
                         2BE RtlAcquireSRWLockExclusive
                         258 NtSetInformationProcess
                         3AE RtlDosPathNameToNtPathName_U_WithStatus
                         2DF RtlAdjustPrivilege
                         277 NtShutdownSystem
                         43A RtlGetGroupSecurityDescriptor
                         368 RtlCreateUnicodeStringFromAsciiz
                          22 DbgPrint
                          7B LdrGetDllHandleEx
                         3AD RtlDosPathNameToNtPathName_U
                         1FA NtQueryPerformanceCounter
                         606 RtlTimeToTimeFields
                         339 RtlConvertSidToUnicodeString
                         623 RtlUnicodeToMultiByteSize
                         4E1 RtlIsTextUnicode
                         622 RtlUnicodeToMultiByteN
                         2E8 RtlAnsiCharToUnicodeChar
                         5B6 RtlSetControlSecurityDescriptor
                         207 NtQuerySystemTime
                         5BF RtlSetEnvironmentVariable
                         50B RtlMakeSelfRelativeSD
                         422 RtlGetControlSecurityDescriptor
                         4F1 RtlLengthSecurityDescriptor
                         3D2 RtlEqualUnicodeString
                         2EE RtlAppendUnicodeStringToString
                         3B7 RtlDuplicateUnicodeString
                         349 RtlCopyUnicodeString
                         29D NtWaitForSingleObject
                         1DE NtQueryEaFile
                         587 RtlReleaseRelativeName
                         24A NtSetEaFile
                         3B0 RtlDosPathNameToRelativeNtPathName_U_WithStatus
                         38F RtlDeleteSecurityObject
                         20A NtQueryValueKey
                         1AA NtOpenFile
                         42B RtlGetDaclSecurityDescriptor
                         274 NtSetValueKey
                         1FF NtQuerySecurityObject
                         1DA NtQueryDirectoryFile
                         39B RtlDestroyEnvironment
                         35F RtlCreateSecurityDescriptor
                         20C NtQueryVolumeInformationFile
                         1B0 NtOpenKeyTransactedEx
                         122 NtCreateKey
                         34C RtlCreateAcl
                         256 NtSetInformationKey
                         1C0 NtOpenThreadToken
                         2A6 NtYieldExecution
                         1E5 NtQueryInformationFile
                         172 NtFsControlFile
                         158 NtDuplicateObject
                         166 NtFlushBuffersFile
                         1D3 NtQueryAttributesFile
                         2CA RtlAddAce
                         150 NtDeleteValueKey
                         429 RtlGetCurrentTransaction
                         544 RtlQueryEnvironmentVariable_U
                         268 NtSetSecurityObject
                         307 RtlCaptureStackBackTrace
                         14C NtDeleteFile
                         517 RtlNewSecurityObjectEx
                          8A LdrLoadDll
                         123 NtCreateKeyTransacted
                         214 NtReadFile
                         2C4 RtlAddAccessAllowedAceEx
                         253 NtSetInformationFile
                         54A RtlQueryInformationAcl
                          AE LdrUnloadDll
                         67B RtlpApplyLengthFunction
                         419 RtlGetAce
                         5BB RtlSetDaclSecurityDescriptor
                         160 NtEnumerateValueKey
                         2A2 NtWriteFile
                         440 RtlGetLengthWithoutLastFullDosOrNtPathElement
                         15D NtEnumerateKey
                          80 LdrGetProcedureAddress
                         5BA RtlSetCurrentTransaction
                         5CA RtlSetOwnerSecurityDescriptor
                         1B7 NtOpenProcessToken
                         14D NtDeleteKey
                         1F3 NtQueryKey
                         327 RtlCompareUnicodeString
                         1F4 NtQueryLicenseValue
                         40D RtlFreeHeap
                         4F2 RtlLengthSid
                         48A RtlInitUnicodeStringEx
                         1EA NtQueryInformationThread
                         25B NtSetInformationThread
                         1F7 NtQueryObject
                         489 RtlInitUnicodeString
                         352 RtlCreateEnvironment
                         6F4 VerSetConditionMask
                         18E NtLoadKey2
                         1AD NtOpenKey
                         1AE NtOpenKeyEx
                         16A NtFlushKey
                         28F NtUnloadKey2
                         11C NtCreateFile
                         205 NtQuerySystemInformation
                         492 RtlInitializeCriticalSection
                         385 RtlDeleteCriticalSection
                         356 RtlCreateHeap
                         4ED RtlLeaveCriticalSection
                         3C3 RtlEnterCriticalSection
                         2E4 RtlAllocateHeap
                         39D RtlDestroyHeap
                         532 RtlPcToFileHeader
                         634 RtlUnwindEx
                         64E RtlVirtualUnwind
                         509 RtlLookupFunctionEntry
                         305 RtlCaptureContext
                         572 RtlRaiseStatus
                         46B RtlGetVersion
                         101 NtClose
                         3DC RtlExpandEnvironmentStrings

    ADVAPI32.dll
             180287A68 Import Address Table
             180328230 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         115 InitializeSecurityDescriptor
                          8E CryptAcquireContextA
                          91 CryptCreateHash
                          A6 CryptHashData
                          94 CryptDestroyHash
                          A2 CryptGetHashParam
                          E3 GetAce
                          F8 GetSecurityDescriptorControl
                          4A CheckTokenMembership
                         250 SetSecurityInfo
                           A AddAccessAllowedAceEx
                         120 IsValidAcl
                          16 AdjustTokenPrivileges
                         231 RevertToSelf
                         123 IsValidSid
                         11B InitiateSystemShutdownExW
                         18C OpenSCManagerW
                          48 ChangeServiceConfigW
                         18E OpenServiceW
                         1F0 RegGetKeySecurity
                         1E2 RegDeleteKeyW
                          5A ConvertSecurityDescriptorToStringSecurityDescriptorW
                         1EE RegEnumValueW
                          63 ConvertStringSidToSidW
                         1EB RegEnumKeyExW
                         200 RegOpenKeyW
                          4F CloseServiceHandle
                         24B SetSecurityDescriptorDacl
                         1CE RegCloseKey
                          DD EventWriteTransfer
                          D7 EventRegister
                          17 AllocateAndInitializeSid
                         1D7 RegCreateKeyExW
                          65 CopySid
                         214 RegSetKeySecurity
                         219 RegSetValueExW
                         18A OpenProcessToken
                          E2 FreeSid
                          A9 CryptReleaseContext
                         114 InitializeAcl
                         1FD RegOpenKeyExW
                          D9 EventUnregister
                         1E6 RegDeleteValueW
                          61 ConvertStringSecurityDescriptorToSecurityDescriptorW
                          F2 GetLengthSid
                           9 AddAccessAllowedAce
                         18F OpenThreadToken
                         209 RegQueryValueExW
                         109 GetTokenInformation
                         122 IsValidSecurityDescriptor
                          BA DestroyPrivateObjectSecurity
                          FB GetSecurityDescriptorLength
                         24C SetSecurityDescriptorGroup
                         17A MakeSelfRelativeSD
                         24D SetSecurityDescriptorOwner
                         248 SetPrivateObjectSecurityEx
                         116 InitializeSid
                          68 CreatePrivateObjectSecurityWithMultipleInheritance
                         105 GetSidLengthRequired
                         106 GetSidSubAuthority
                          C3 EnableTraceEx2
                          57 ControlTraceW
                          DC EventWriteString
                          D0 EqualSid

    KERNEL32.dll
             180287CA8 Import Address Table
             180328470 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         4A9 VirtualAlloc
                         4AC VirtualFree
                         1AE GetDriveTypeW
                         39B RaiseFailFastException
                         34C OpenEventW
                          95 CreateThread
                         1B9 GetExitCodeThread
                         297 GetWindowsDirectoryW
                         4B8 WaitForMultipleObjects
                         1E1 GetLogicalDrives
                         28F GetVolumeInformationW
                         2CD InitializeSRWLock
                         2B3 HeapCreate
                         23D GetShortPathNameW
                         426 SetFileTime
                         16C GetComputerNameExW
                         2BD HeapWalk
                         2BC HeapValidate
                         1E0 GetLogicalDriveStringsW
                         21C GetPrivateProfileStringW
                         2AB GlobalSize
                         28B GetVersionExA
                         20A GetOverlappedResult
                         2B2 HeapCompact
                         482 SystemTimeToTzSpecificLocalTime
                         2B4 HeapDestroy
                         2A9 GlobalMemoryStatusEx
                         2A7 GlobalLock
                          64 CreateDirectoryW
                         3A8 ReadFile
                         1EC GetModuleFileNameA
                         1C3 GetFileInformationByHandleEx
                         118 FindFirstFileW
                         1C7 GetFileSizeEx
                          88 CreateProcessA
                          4C CompareStringW
                          8F CreateSemaphoreExW
                         2B5 HeapFree
                         430 SetLastError
                          CF EnterCriticalSection
                         1C9 GetFileType
                         2A8 GlobalMemoryStatus
                         2AC GlobalUnlock
                         123 FindNextFileW
                         19A GetCurrentProcess
                         3C3 ReleaseSemaphore
                         4EF WriteFile
                         1F0 GetModuleHandleExW
                          FF ExpandEnvironmentStringsW
                         437 SetPriorityClass
                         27E GetTimeZoneInformation
                         215 GetPriorityClass
                         1ED GetModuleFileNameW
                         4AF VirtualProtect
                         31F LoadLibraryExA
                         226 GetProcessId
                         2C8 InitializeCriticalSectionAndSpinCount
                         31A LeaveCriticalSection
                         420 SetFileAttributesW
                         1B6 GetEnvironmentVariableW
                         414 SetEndOfFile
                         266 GetTempPathW
                          82 CreateMutexW
                         2C9 InitializeCriticalSectionEx
                         4BD WaitForThreadpoolTimerCallbacks
                         10F FindClose
                         4BA WaitForSingleObject
                          75 CreateFileW
                         1C1 GetFileAttributesW
                         19F GetCurrentThreadId
                         419 SetErrorMode
                         28C GetVersionExW
                         3BF ReleaseMutex
                         24E GetSystemDirectoryW
                         358 OpenProcess
                         291 GetVolumeNameForVolumeMountPointW
                          69 CreateEventW
                         344 MultiByteToWideChar
                         478 Sleep
                         13E FormatMessageW
                         27A GetTickCount64
                         1DA GetLastError
                         3C1 ReleaseSRWLockExclusive
                         360 OutputDebugStringW
                         41A SetEvent
                          44 CloseThreadpoolTimer
                         1A8 GetDiskFreeSpaceExW
                         19E GetCurrentThread
                           0 AcquireSRWLockExclusive
                         4BB WaitForSingleObjectEx
                          B5 DeleteFileW
                         35A OpenSemaphoreW
                          3B CloseHandle
                         465 SetThreadpoolTimer
                         3C2 ReleaseSRWLockShared
                         251 GetSystemInfo
                          99 CreateThreadpoolTimer
                         3CF ResetEvent
                         2B1 HeapAlloc
                         21E GetProcAddress
                         425 SetFilePointerEx
                          81 CreateMutexExW
                         328 LocalFree
                         33E MoveFileExW
                           1 AcquireSRWLockShared
                          B1 DeleteCriticalSection
                         19B GetCurrentProcessId
                         224 GetProcessHeap
                          89 CreateProcessW
                         1F1 GetModuleHandleW
                         142 FreeLibrary
                          59 CopyFileW
                         4DE WideCharToMultiByte
                         499 UnmapViewOfFile
                         262 GetTempFileNameW
                          A8 DebugBreak
                         25B GetSystemWindowsDirectoryW
                          FD ExitThread
                         340 MoveFileW
                         320 LoadLibraryExW
                         2DD IsDebuggerPresent
                         46B SetUnhandledExceptionFilter
                         1B8 GetExitCodeProcess
                         496 UnhandledExceptionFilter
                         485 TerminateProcess
                         2E3 IsProcessorFeaturePresent
                         131 FlsAlloc
                         133 FlsGetValue
                         134 FlsSetValue
                         132 FlsFree
                         257 GetSystemTimeAsFileTime
                         30E LCMapStringW
                         1DE GetLocaleInfoW
                         2E8 IsValidCodePage
                         149 GetACP
                         209 GetOEMCP
                         157 GetCPInfo
                         246 GetStringTypeW
                          FC ExitProcess
                         2BA HeapSize
                         39A RaiseException
                         240 GetStartupInfoW
                         38E QueryPerformanceCounter
                         2CC InitializeSListHead
                         4B1 VirtualQuery
                         2D0 InterlockedFlushSList
                          CB EncodePointer
                          4B CompareStringOrdinal
                         30B LCIDToLocaleName
                         143 FreeLibraryAndExitThread
                         165 GetCommandLineA
                         1B4 GetEnvironmentStringsW
                         3D4 ResolveLocaleName
                         50A lstrcmpW
                         2C7 InitializeCriticalSection
                         1D3 GetFullPathNameW
                         1DB GetLocalTime
                         3C7 RemoveDirectoryW
                         1A9 GetDiskFreeSpaceW
                         1EF GetModuleHandleExA
                         424 SetFilePointer
                         422 SetFileInformationByHandle
                         29E GlobalAlloc
                         2A3 GlobalFree
                         4A8 VerifyVersionInfoW
                         136 FlushFileBuffers
                         35F OutputDebugStringA
                         335 MapViewOfFile
                         321 LoadLibraryW
                         255 GetSystemTime
                         115 FindFirstFileExW
                         141 FreeEnvironmentStringsW
                         241 GetStdHandle
                         447 SetStdHandle
                         184 GetConsoleOutputCP
                         181 GetConsoleMode
                         3A5 ReadConsoleW
                         1B7 GetErrorMode
                         1E6 GetLongPathNameW
                         194 GetCurrentDirectoryW
                         1C2 GetFileInformationByHandle
                          57 CopyFileExW
                         166 GetCommandLineW
                         4B9 WaitForMultipleObjectsEx
                         45C SetThreadPriority
                          C9 DuplicateHandle
                         272 GetThreadPriority
                         48C TlsSetValue
                         489 TlsAlloc
                         48B TlsGetValue
                         48A TlsFree
                          6E CreateFileMappingA
                         279 GetTickCount
                          7F CreateMutexA
                         28A GetVersion
                          6D CreateFileA
                         2B8 HeapReAlloc
                          B3 DeleteFileA
                         4EE WriteConsoleW
                         28E GetVolumeInformationByHandleW
                         1C6 GetFileSize
                         2C2 InitOnceExecuteOnce
                         1CB GetFinalPathNameByHandleW
                          C0 DeviceIoControl
                          72 CreateFileMappingW

    OLE32.dll
             180288318 Import Address Table
             180328AE0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           C CLSIDFromString
                         187 StringFromGUID2
                          7E CoTaskMemAlloc
                          25 CoCreateGuid
                          95 CreateItemMoniker
                          AA GetRunningObjectTable
                          58 CoInitializeEx
                          7B CoSetProxyBlanket
                          7F CoTaskMemFree
                          26 CoCreateInstance
                          84 CoUninitialize
                          49 CoGetMalloc

    USER32.dll
             1802883F8 Import Address Table
             180328BC0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         292 UnregisterClassA
                          21 CharNextW

    VERSION.dll
             180288410 Import Address Table
             180328BD8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 GetFileVersionInfoExW
                           5 GetFileVersionInfoSizeExW
                           D VerQueryValueW

    SHLWAPI.dll
             1802883E8 Import Address Table
             180328BB0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          67 PathMatchSpecW

    RPCRT4.dll
             1802883B8 Import Address Table
             180328B80 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         21E UuidCreate
                         215 RpcStringFreeW
                         227 UuidToStringW
                          44 I_RpcMapWin32Status
                         223 UuidFromStringW

    wer.dll
             1802888D8 Import Address Table
             1803290A0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           D WerReportSubmit
                           9 WerReportCloseHandle
                           8 WerReportAddFile
                           B WerReportSetParameter
                           C WerReportSetUIOption
                           A WerReportCreate

    CFGMGR32.dll
             180287C70 Import Address Table
             180328438 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          76 CM_Get_Device_Interface_ListW
                          7A CM_Get_Device_Interface_List_SizeW
                          7D CM_Get_Device_Interface_PropertyW

  Section contains the following delay load imports:

    WIMGAPI.DLL
              00000001 Characteristics
      000000018032E710 Address of HMODULE
      0000000180346000 Import Address Table
      0000000180327E78 Import Name Table
      0000000180327F00 Bound Import Name Table
      0000000000000000 Unload Import Name Table
                     0 time date stamp

                                    000000018025DC2C     7 WIMCloseHandle
                                    000000018025DCB7    36 WIMSetTemporaryPath
                                    000000018025DCC9     5 WIMApplyImage
                                    000000018025DCDB    25 WIMLoadImage
                                    000000018025DCED     A WIMCreateFile

  Summary

        B000 .data
        1000 .didat
        F000 .pdata
       AE000 .rdata
        2000 .reloc
        1000 .rsrc
      279000 .text
        3000 PAGE
        1000 PAGECMRC
